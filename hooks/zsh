memy_preexec() {
  local cmd="$1"

  for word in ${(z)cmd}; do
    eval "expanded=\${~word}"

    if [[ -e $expanded ]]; then
      memy \
        --config denied_files_warn_on_note=false \
        --config missing_files_warn_on_note=false \
        note "$expanded" &!
    fi
  done
}

autoload -Uz add-zsh-hook

add-zsh-hook preexec memy_preexec

alias memy-cd='selected=$(memy list -d | fzf); [[ -n "$selected" ]] && cd "${selected/#\~/$HOME}"'
